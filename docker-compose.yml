version: '2'
volumes:
  laisdb-data:
services:
  mqttautodomo:
    image: eclipse-mosquitto
    restart: always
    volumes:
      - laisdb-data:/mosquitto/config/mosquitto/config
      - laisdb-data:/mosquitto/data/mosquitto/data
    ports:
      - 1883:1883
      - 9001:9001

  noderedautodomo:
    image: raymondmm/node-red
    restart: always
    ports:
      - 1880:1880
      - 8082:8082
      - 8080:8080
    volumes:
      - laisdb-data:/nodered/.node-red/data/data
      
  db:
    image: biarms/mysql
    restart: always
    environment:
      MYSQL_DATABASE: ${MYSQL_DATABASE}
      MYSQL_USER: ${MYSQL_USER}
      MYSQL_PASSWORD: ${MYSQL_PASSWORD}
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
    volumes:
      - laisdb-data:/mariadb/docker-entrypoint-initdb.d
    ports:
      - 3306:3306

  phpmyadmin:
    image: sk278/phpmyadmin-armhf:4.8.3
    restart: always
    ports:
      - 8081:80
    depends_on:
      - db

  homeGbridge:
    image: eltonssilva/gbridgeconnect:armv7_1.1
    restart: always
    depends_on:
      - db

  nodediverso:
    image: eltonssilva/nodediverso:armv7_1.0
    restart: always
    volumes:
      - laisdb-data:/configs/home/node/app/configs
    depends_on:
      - db
    ports:
      - 8085:8085
      - 4555:4555

  supervisorio:
    image: eltonssilva/supervisorio:armv7_1.0
    restart: always

    ports:
      - 80:80
      - 443:443
    volumes:
      - laisdb-data:/php/www/var/www/html/
      - laisdb-data:/homekit/accessories/home/pi/HAP-NodeJS/accessories/
      - laisdb-data:/configs/home/node/app/configs
      - laisdb-data:/php/localcerts/etc/ssl/localcerts/
      - laisdb-data:/php/sites-available/etc/apache2/sites-available/
      - laisdb-data:/php/sites-enabled/etc/apache2/sites-enabled/
      - laisdb-data:/php/mods-enabled/ssl.conf/etc/apache2/mods-enabled/ssl.conf
      - laisdb-data:/php/mods-enabled/ssl.load/etc/apache2/mods-enabled/ssl.load
      - laisdb-data:/php/mods-enabled/socache_shmcb.load/etc/apache2/mods-enabled/socache_shmcb.load
      - laisdb-data:/mosquitto/config/etc/mosquitto/config
      - laisdb-data:/mosquitto/data/etc/mosquitto/data
    
  homekit:
    image: eltonssilva/homekit:armv7_1.0
    restart: always
    network_mode: host

    ports:
      - 51826:51826
      - 5353:5353
    volumes:
      - laisdb-data:/homekit/accessories/home/HAP-NodeJS/accessories

  zigbee2mqtt:
    image: koenkk/zigbee2mqtt:latest
    volumes:
      - laisdb-data:/zigbee2mqtt/data/app/data
    privileged: true
    devices:
      - /dev:/dev
    restart: always
    network_mode: host
    environment:
      - TZ=Europe/Amsterdam
